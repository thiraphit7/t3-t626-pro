/dts-v1/;

/*
 * Device Tree for T3 T626Pro (Airoha EN7529)
 * 
 * Based on: Airoha EN7523 EVB
 * SoC: EN7529 (EN7523 family)
 * Board: T3 T626Pro
 * 
 * Hardware Specs:
 * - CPU: Dual-core ARM Cortex-A53 @ 1.3 GHz
 * - RAM: 512 MB DDR3
 * - Flash: NAND (SPI-NAND) - TBD size
 * - Ethernet: 5x GbE ports (via internal switch)
 * - Serial: 1x UART (115200 8N1)
 * 
 * TODO: ปรับแต่งตามฮาร์ดแวร์จริงของ T626Pro:
 * - NAND flash size และ partitions
 * - Ethernet switch configuration
 * - GPIO pins (LEDs, buttons, reset)
 * - USB ports (ถ้ามี)
 */

#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/input/input.h>

/ {
    model = "T3 T626Pro";
    compatible = "t3,t626pro", "airoha,en7529", "airoha,en7523";

    #address-cells = <1>;
    #size-cells = <1>;

    aliases {
        serial0 = &uart0;
        ethernet0 = &eth0;
    };

    chosen {
        stdout-path = "serial0:115200n8";
        bootargs = "console=ttyS0,115200 earlycon";
    };

    memory@80000000 {
        device_type = "memory";
        reg = <0x80000000 0x20000000>; /* 512 MB */
    };

    cpus {
        #address-cells = <1>;
        #size-cells = <0>;

        cpu@0 {
            device_type = "cpu";
            compatible = "arm,cortex-a53";
            reg = <0x0>;
            enable-method = "psci";
        };

        cpu@1 {
            device_type = "cpu";
            compatible = "arm,cortex-a53";
            reg = <0x1>;
            enable-method = "psci";
        };
    };

    psci {
        compatible = "arm,psci-0.2";
        method = "smc";
    };

    /* System Controller */
    soc {
        compatible = "simple-bus";
        #address-cells = <1>;
        #size-cells = <1>;
        ranges;

        /* Serial Console */
        uart0: serial@1fbf0000 {
            compatible = "ns16550a";
            reg = <0x1fbf0000 0x1000>;
            interrupts = <0 18 4>;
            clock-frequency = <40000000>;
            reg-shift = <2>;
            reg-io-width = <4>;
            status = "okay";
        };

        /* Ethernet */
        eth0: ethernet@1fb00000 {
            compatible = "airoha,en7523-eth";
            reg = <0x1fb00000 0x10000>;
            interrupts = <0 30 4>;
            status = "okay";

            /* TODO: Configure switch ports */
            /*
            fixed-link {
                speed = <1000>;
                full-duplex;
            };
            */
        };

        /* SPI-NAND Flash Controller */
        spi_nand: spi@1fa10000 {
            compatible = "airoha,en7523-snand";
            reg = <0x1fa10000 0x1000>;
            #address-cells = <1>;
            #size-cells = <0>;
            status = "okay";

            nand@0 {
                compatible = "spi-nand";
                reg = <0>;
                spi-max-frequency = <50000000>;

                /* TODO: ปรับ partition ตามบอร์ดจริง */
                partitions {
                    compatible = "fixed-partitions";
                    #address-cells = <1>;
                    #size-cells = <1>;

                    partition@0 {
                        label = "u-boot";
                        reg = <0x00000000 0x00080000>; /* 512 KB */
                        read-only;
                    };

                    partition@80000 {
                        label = "u-boot-env";
                        reg = <0x00080000 0x00040000>; /* 256 KB */
                    };

                    partition@c0000 {
                        label = "kernel";
                        reg = <0x000c0000 0x00800000>; /* 8 MB */
                    };

                    partition@8c0000 {
                        label = "rootfs";
                        reg = <0x008c0000 0x07700000>; /* 119 MB */
                    };

                    partition@7fc0000 {
                        label = "config";
                        reg = <0x07fc0000 0x00040000>; /* 256 KB */
                    };
                };
            };
        };

        /* GPIO Controller */
        gpio0: gpio@1fbf0200 {
            compatible = "airoha,en7523-gpio";
            reg = <0x1fbf0200 0x100>;
            gpio-controller;
            #gpio-cells = <2>;
            interrupt-controller;
            #interrupt-cells = <2>;
        };
    };

    /* LEDs - TODO: ปรับตาม GPIO จริงของ T626Pro */
    leds {
        compatible = "gpio-leds";

        led_status: status {
            label = "t626pro:green:status";
            gpios = <&gpio0 10 GPIO_ACTIVE_LOW>;
            default-state = "on";
        };

        led_wan: wan {
            label = "t626pro:green:wan";
            gpios = <&gpio0 11 GPIO_ACTIVE_LOW>;
        };

        led_lan: lan {
            label = "t626pro:green:lan";
            gpios = <&gpio0 12 GPIO_ACTIVE_LOW>;
        };
    };

    /* Buttons - TODO: ปรับตาม GPIO จริง */
    keys {
        compatible = "gpio-keys";

        reset {
            label = "reset";
            gpios = <&gpio0 9 GPIO_ACTIVE_LOW>;
            linux,code = <KEY_RESTART>;
        };

        wps {
            label = "wps";
            gpios = <&gpio0 8 GPIO_ACTIVE_LOW>;
            linux,code = <KEY_WPS_BUTTON>;
        };
    };
};
